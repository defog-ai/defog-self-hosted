I tried running a SQL query on a {db_type} database, but it failed.

This was my query:
{sql}

This was the error:
{error}

This was the question I was trying to answer:
{question}

Here is the metadata for the tables in the database:
{table_metadata_ddl}

Can you please return the corrected SQL query? Return just the SQL query, nothing else.