(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{36429:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return o(95742)}])},31143:function(e,t,o){"use strict";var n=o(28598),s=o(1887),a=o.n(s);t.Z=()=>(0,n.jsxs)(a(),{children:[(0,n.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,n.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,t,o){"use strict";var n=o(28598),s=o(82684),a=o(91568),i=o(79869);t.Z=e=>{let{id:t,userType:o,children:l}=e,{Content:r,Sider:c}=i.Layout,[u,d]=(0,s.useState)([]),[h,f]=(0,s.useContext)(a._),logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),f({user:null,token:null,userType:null}),window.location.href="/login"};return(0,s.useEffect)(()=>{d("admin"==o?[{key:"manage-database",title:"Manage Database",icon:(0,n.jsx)("a",{href:"/extract-metadata",children:"\uD83D\uDCBE Manage DB"})},{key:"manage-users",title:"Manage Users",icon:(0,n.jsx)("a",{href:"/manage-users",children:"\uD83D\uDD10 Manage Users"})},{key:"view-notebook",title:"View your notebook",icon:(0,n.jsx)("a",{href:"/view-notebooks",children:"\uD83D\uDCD2 Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,n.jsx)("a",{href:"#",onClick:logout,children:"â†ª Logout"})}]:[{key:"view-notebook",title:"View your notebook",icon:(0,n.jsx)("a",{href:"/view-notebooks",children:"Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,n.jsx)("a",{href:"#",onClick:logout,children:"Logout"})}])},[o]),(0,n.jsx)(i.Layout,{style:{height:"100vh"},children:(0,n.jsxs)(r,{children:[(0,n.jsx)(c,{style:{height:"100vh",position:"fixed"},children:(0,n.jsx)(i.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[t],items:u})}),(0,n.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:l})]})})}},95742:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return login}});var n=o(28598),s=o(82684),a=o(34376),i=o(31143),l=o(62429),r=o(91568),c=o(33612),u=o(85439),d=o(20259),h=o.n(d),f=o(79204),common_SSOButton=e=>{let{msalInstance:t}=e,[o,i]=(0,s.useState)(!1),l=(0,a.useRouter)(),[c,u]=(0,s.useContext)(r._),handleLogin=async()=>{if(!o){i(!0);try{let e=await t.loginPopup({scopes:["user.read"]}),o=null==e?void 0:e.idToken;console.log("Login successful!");let n=(0,f.Z)("http","validate_ms_sso"),s=await fetch(n,{method:"POST",body:JSON.stringify({token:o}),headers:{"Content-Type":"application/json"}}),a=await s.json();i(!1),"success"===a.status&&(u({user:a.user,token:a.token,userType:a.user_type}),localStorage.setItem("defogUser",a.user),localStorage.setItem("defogToken",a.token),localStorage.setItem("defogUserType",a.user_type),l.push("/"))}catch(e){console.error(e)}i(!1)}};return(0,n.jsx)("button",{onClick:handleLogin,children:"Sign In with Microsoft"})},g=o(65512),login=()=>{let[e,t]=(0,s.useContext)(r._),[o,d]=(0,s.useState)(null),m=(0,a.useRouter)();(0,s.useEffect)(()=>{!async function(){let e=await g.L.createPublicClientApplication({auth:{clientId:"".concat("08d036ea-f4fa-4636-b32b-3196bac0bfe7"),authority:"https://login.microsoftonline.com/".concat("91477b80-6e9d-4a55-bce4-8c2e49d1870f"),redirectUri:"".concat("http://localhost:1234/msal_redirect")}});d(e)}()},[]);let handleLogin=async e=>{let o=(0,f.Z)("http","login"),n=await fetch(o,{method:"POST",body:JSON.stringify(e)}),s=await n.json();"success"===s.status&&(t({user:e.username,token:s.token,userType:s.user_type}),localStorage.setItem("defogUser",e.username),localStorage.setItem("defogToken",s.token),localStorage.setItem("defogUserType",s.user_type),m.push("/"))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{}),(0,n.jsxs)(l.Z,{children:[(0,n.jsx)("h1",{style:{paddingBottom:"1em"},children:"Welcome to Defog!"}),(0,n.jsxs)(u.default,{labelCol:{span:4},wrapperCol:{span:20},style:{maxWidth:800},onFinish:handleLogin,children:[(0,n.jsx)(u.default.Item,{label:"Username",name:"username",children:(0,n.jsx)(c.default,{})}),(0,n.jsx)(u.default.Item,{label:"Password",name:"password",children:(0,n.jsx)(c.default.Password,{})}),(0,n.jsx)(u.default.Item,{children:(0,n.jsx)(h(),{type:"primary",htmlType:"submit",children:"Log In"})})]}),o?(0,n.jsx)(common_SSOButton,{msalInstance:o}):null]})]})}},79204:function(e,t){"use strict";t.Z=(e,t)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return""!==t?"".concat(e,"://").concat("localhost:80","/").concat(t):"".concat(e,"://").concat("localhost:80")}}},function(e){e.O(0,[456,958,360,774,888,179],function(){return e(e.s=36429)}),_N_E=e.O()}]);