(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{53866:function(e,t){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{PrefetchKind:function(){return n},ACTION_REFRESH:function(){return r},ACTION_NAVIGATE:function(){return i},ACTION_RESTORE:function(){return a},ACTION_SERVER_PATCH:function(){return c},ACTION_PREFETCH:function(){return l},ACTION_FAST_REFRESH:function(){return s},ACTION_SERVER_ACTION:function(){return u}});let r="refresh",i="navigate",a="restore",c="server-patch",l="prefetch",s="fast-refresh",u="server-action";(o=n||(n={})).AUTO="auto",o.FULL="full",o.TEMPORARY="temporary",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},11746:function(e,t,n){"use strict";function getDomainLocale(e,t,n,o){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return getDomainLocale}}),n(3890),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},39261:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return b}});let o=n(43709),r=o._(n(82684)),i=n(40342),a=n(53186),c=n(78858),l=n(11119),s=n(80873),u=n(14850),d=n(88674),f=n(77140),p=n(11746),h=n(12341),g=n(53866),m=new Set;function prefetch(e,t,n,o,r,i){if(!i&&!(0,a.isLocalURL)(t))return;if(!o.bypassPrefetchedCheck){let r=void 0!==o.locale?o.locale:"locale"in e?e.locale:void 0,i=t+"%"+n+"%"+r;if(m.has(i))return;m.add(i)}let c=i?e.prefetch(t,r):e.prefetch(t,n,o);Promise.resolve(c).catch(e=>{})}function formatStringOrUrl(e){return"string"==typeof e?e:(0,c.formatUrl)(e)}let v=r.default.forwardRef(function(e,t){let n,o;let{href:c,as:m,children:v,prefetch:b=null,passHref:y,replace:x,shallow:_,scroll:j,locale:k,onClick:w,onMouseEnter:O,onTouchStart:T,legacyBehavior:C=!1,...E}=e;n=v,C&&("string"==typeof n||"number"==typeof n)&&(n=r.default.createElement("a",null,n));let N=r.default.useContext(u.RouterContext),I=r.default.useContext(d.AppRouterContext),S=null!=N?N:I,D=!N,P=!1!==b,L=null===b?g.PrefetchKind.AUTO:g.PrefetchKind.FULL,{href:M,as:A}=r.default.useMemo(()=>{if(!N){let e=formatStringOrUrl(c);return{href:e,as:m?formatStringOrUrl(m):e}}let[e,t]=(0,i.resolveHref)(N,c,!0);return{href:e,as:m?(0,i.resolveHref)(N,m):t||e}},[N,c,m]),R=r.default.useRef(M),U=r.default.useRef(A);C&&(o=r.default.Children.only(n));let F=C?o&&"object"==typeof o&&o.ref:t,[K,H,V]=(0,f.useIntersection)({rootMargin:"200px"}),Z=r.default.useCallback(e=>{(U.current!==A||R.current!==M)&&(V(),U.current=A,R.current=M),K(e),F&&("function"==typeof F?F(e):"object"==typeof F&&(F.current=e))},[A,F,M,V,K]);r.default.useEffect(()=>{S&&H&&P&&prefetch(S,M,A,{locale:k},{kind:L},D)},[A,M,H,k,P,null==N?void 0:N.locale,S,D,L]);let z={ref:Z,onClick(e){C||"function"!=typeof w||w(e),C&&o.props&&"function"==typeof o.props.onClick&&o.props.onClick(e),S&&!e.defaultPrevented&&function(e,t,n,o,i,c,l,s,u,d){let{nodeName:f}=e.currentTarget,p="A"===f.toUpperCase();if(p&&(function(e){let t=e.currentTarget,n=t.getAttribute("target");return n&&"_self"!==n||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!u&&!(0,a.isLocalURL)(n)))return;e.preventDefault();let navigate=()=>{let e=null==l||l;"beforePopState"in t?t[i?"replace":"push"](n,o,{shallow:c,locale:s,scroll:e}):t[i?"replace":"push"](o||n,{forceOptimisticNavigation:!d,scroll:e})};u?r.default.startTransition(navigate):navigate()}(e,S,M,A,x,_,j,k,D,P)},onMouseEnter(e){C||"function"!=typeof O||O(e),C&&o.props&&"function"==typeof o.props.onMouseEnter&&o.props.onMouseEnter(e),S&&(P||!D)&&prefetch(S,M,A,{locale:k,priority:!0,bypassPrefetchedCheck:!0},{kind:L},D)},onTouchStart(e){C||"function"!=typeof T||T(e),C&&o.props&&"function"==typeof o.props.onTouchStart&&o.props.onTouchStart(e),S&&(P||!D)&&prefetch(S,M,A,{locale:k,priority:!0,bypassPrefetchedCheck:!0},{kind:L},D)}};if((0,l.isAbsoluteUrl)(A))z.href=A;else if(!C||y||"a"===o.type&&!("href"in o.props)){let e=void 0!==k?k:null==N?void 0:N.locale,t=(null==N?void 0:N.isLocaleDomain)&&(0,p.getDomainLocale)(A,e,null==N?void 0:N.locales,null==N?void 0:N.domainLocales);z.href=t||(0,h.addBasePath)((0,s.addLocale)(A,e,null==N?void 0:N.defaultLocale))}return C?r.default.cloneElement(o,z):r.default.createElement("a",{...E,...z},n)}),b=v;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},77140:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return useIntersection}});let o=n(82684),r=n(14957),i="function"==typeof IntersectionObserver,a=new Map,c=[];function useIntersection(e){let{rootRef:t,rootMargin:n,disabled:l}=e,s=l||!i,[u,d]=(0,o.useState)(!1),f=(0,o.useRef)(null),p=(0,o.useCallback)(e=>{f.current=e},[]);(0,o.useEffect)(()=>{if(i){if(s||u)return;let e=f.current;if(e&&e.tagName){let o=function(e,t,n){let{id:o,observer:r,elements:i}=function(e){let t;let n={root:e.root||null,margin:e.rootMargin||""},o=c.find(e=>e.root===n.root&&e.margin===n.margin);if(o&&(t=a.get(o)))return t;let r=new Map,i=new IntersectionObserver(e=>{e.forEach(e=>{let t=r.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)})},e);return t={id:n,observer:i,elements:r},c.push(n),a.set(n,t),t}(n);return i.set(e,t),r.observe(e),function(){if(i.delete(e),r.unobserve(e),0===i.size){r.disconnect(),a.delete(o);let e=c.findIndex(e=>e.root===o.root&&e.margin===o.margin);e>-1&&c.splice(e,1)}}}(e,e=>e&&d(e),{root:null==t?void 0:t.current,rootMargin:n});return o}}else if(!u){let e=(0,r.requestIdleCallback)(()=>d(!0));return()=>(0,r.cancelIdleCallback)(e)}},[s,n,t,u,f.current]);let h=(0,o.useCallback)(()=>{d(!1)},[]);return[p,u,h]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},12691:function(e,t,n){e.exports=n(39261)},84308:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/view-notebooks",function(){return n(86369)}])},31143:function(e,t,n){"use strict";var o=n(28598),r=n(1887),i=n.n(r);t.Z=()=>(0,o.jsxs)(i(),{children:[(0,o.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,o.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,o.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,t,n){"use strict";var o=n(28598),r=n(82684),i=n(91568),a=n(79869);t.Z=e=>{let{id:t,userType:n,children:c}=e,{Content:l,Sider:s}=a.Layout,[u,d]=(0,r.useState)([]),[f,p]=(0,r.useContext)(i._),logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),p({user:null,token:null,userType:null}),window.location.href="/login"};return(0,r.useEffect)(()=>{d("admin"==n?[{key:"manage-database",title:"Manage Database",icon:(0,o.jsx)("a",{href:"/extract-metadata",children:"\uD83D\uDCBE Manage DB"})},{key:"manage-users",title:"Manage Users",icon:(0,o.jsx)("a",{href:"/manage-users",children:"\uD83D\uDD10 Manage Users"})},{key:"view-notebook",title:"View your notebook",icon:(0,o.jsx)("a",{href:"/view-notebooks",children:"\uD83D\uDCD2 Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,o.jsx)("a",{href:"#",onClick:logout,children:"â†ª Logout"})}]:[{key:"view-notebook",title:"View your notebook",icon:(0,o.jsx)("a",{href:"/view-notebooks",children:"Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,o.jsx)("a",{href:"#",onClick:logout,children:"Logout"})}])},[n]),(0,o.jsx)(a.Layout,{style:{height:"100vh"},children:(0,o.jsxs)(l,{children:[(0,o.jsx)(s,{style:{height:"100vh",position:"fixed"},children:(0,o.jsx)(a.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[t],items:u})}),(0,o.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:c})]})})}},86369:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return view_notebooks}});var o=n(15059),r=n(28598),i=n(82684),a=n(49060),c=n(77652),l=n(12691),s=n.n(l);function _templateObject(){let e=(0,o._)(["\n  width: 200px;\n  margin: 10px;\n  margin-bottom: 2em;\n  position: relative;\n\n  &:hover {\n    .doc-archive-icon {\n      opacity: 1;\n    }\n  }\n\n  .doc-archive-icon {\n    position: absolute;\n    top: -10px;\n    right: -10px;\n    opacity: 0;\n    cursor: pointer;\n    font-size: 15px;\n    padding: 5px;\n    background-color: white;\n    border: 1px solid #949494;\n    border-radius: 50%;\n    height: 30px;\n    width: 30px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 4;\n    svg path:not(:first-child) {\n      stroke: #949494;\n    }\n  }\n\n  .doc-icon {\n    border-radius: 8px;\n    width: 100%;\n    height: 150px;\n    display: flex;\n    justify-content: center;\n    align-items: left;\n    background: #a8b1c021;\n    flex-direction: column;\n    padding: 20px;\n\n    &.add-doc {\n      align-items: center;\n      .add-doc-plus {\n        font-size: 3rem;\n        font-weight: bold;\n        color: #a8b1c0c3;\n      }\n    }\n    .stage-icon-label {\n      color: #a8b1c0ff;\n      font-weight: bold;\n      &.done {\n        color: #a8b1c061;\n        text-decoration: line-through;\n        .anticon {\n          margin-left: 4px;\n        }\n      }\n    }\n  }\n  .doc-title {\n    color: #a8b1c0ff;\n    font-weight: bold;\n    margin-top: 1em;\n  }\n  .doc-date {\n    color: #a8b1c0ff;\n    font-weight: bold;\n  }\n"]);return _templateObject=function(){return e},e}function DocIcon(e){var t;let{doc:n,addDocIcon:o=!1,recentlyViewed:i=!1,onClick:a=null}=e;return(0,r.jsxs)(u,{children:[(0,r.jsxs)(s(),{target:"_blank",href:{pathname:"/doc",query:{docId:o?"new":n&&n.doc_id}},children:[(0,r.jsx)("div",{className:"doc-icon "+(o?"add-doc":""),children:o?(0,r.jsx)("p",{className:"add-doc-plus",children:"ï¼‹"}):(0,r.jsx)(r.Fragment,{})}),(0,r.jsx)("p",{className:"doc-title",children:o?"New doc":n.doc_title?n.doc_title:"Untitled"}),(0,r.jsxs)("p",{className:"doc-date",children:[i?"Last accessed: ":"",o?"":null==n?void 0:null===(t=n.timestamp)||void 0===t?void 0:t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}),i?(0,r.jsxs)("p",{className:"doc-date",children:["Created by: ",null==n?void 0:n.created_by]}):(0,r.jsx)(r.Fragment,{})]}),o||i?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)("div",{className:"doc-archive-icon",onClick:e=>{!a||"function"!=typeof a||o||i||(e.preventDefault(),a(n))},children:n.archived?(0,r.jsx)(c.IgE,{}):(0,r.jsx)(c.pu4,{})})]})}let u=a.ZP.div(_templateObject());var d=n(91568),f=n(31143),p=n(54186),h=n(18953),g=n(62429);function view_notebooks_templateObject(){let e=(0,o._)(["\n  .archived-collapse {\n    background-color: transparent;\n    .ant-collapse-content {\n      .ant-collapse-content-box {\n        padding: 0;\n      }\n    }\n  }\n  .doc-icons-container {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: left;\n    margin: 0 auto;\n    padding: 20px;\n    a {\n      position: relative;\n    }\n  }\n  .header {\n    margin: 20px;\n  }\n"]);return view_notebooks_templateObject=function(){return e},e}let m=a.ZP.div(view_notebooks_templateObject());var view_notebooks=()=>{let[e,t]=(0,i.useState)(!1),[n,o]=(0,i.useContext)(d._),[a,c]=(0,i.useState)([]),[l,s]=(0,i.useState)([]),[u,v]=(0,i.useState)([]);async function archiveToggle(e){let t=e.doc_id,n=e.archived,o=u,r=a;n?(o=u.filter(e=>e.doc_id!==t),r=[...a,...u.filter(e=>e.doc_id===t).map(e=>(e.archived=!1,e))]):(o=[...u,...a.filter(e=>e.doc_id===t).map(e=>(e.archived=!0,e))],r=a.filter(e=>e.doc_id!==t)),v(o),c(r);let i=await fetch("http://".concat("localhost:80","/toggle_archive_status"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({doc_id:t,archive_status:!n})});(i=await i.json()).success&&h.default.success("Successfully ".concat(n?"un":"","archived doc")),i.success||h.default.error("Error ".concat(n?"un":"","archiving doc"))}let getNotebooks=async()=>{if(!n.token)return;let e=await fetch("http://".concat("localhost:80","/get_docs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:n.token,username:n.user})});if((e=await e.json()).success){let t=e.docs,o=e.recently_viewed_docs||[];t.forEach(e=>{e.timestamp=new Date(e.timestamp)}),o=o.map(e=>({...e,timestamp:new Date(e.timestamp),created_by:e.username===n.user?"You":e.username})),t.sort((e,t)=>t.timestamp-e.timestamp),s(o),o.sort((e,t)=>t.timestamp-e.timestamp);let r=t.filter(e=>e.archived);t=t.filter(e=>!e.archived),v(r),c(t)}if(!e.success)throw Error(e.error_message);t(!1)};return(0,i.useEffect)(()=>{t(!0);let e=n.token,r=n.userType;if(!r){let t=localStorage.getItem("defogUser");if(e=localStorage.getItem("defogToken"),r=localStorage.getItem("defogUserType"),!t||!e||!r){router.push("/login");return}o({user:t,token:e,userType:r})}e?getNotebooks():router.push("/login")},[n,n.token]),(0,r.jsxs)(m,{children:[(0,r.jsx)(f.Z,{}),(0,r.jsxs)(g.Z,{id:"view-notebooks",userType:n.userType,children:[(0,r.jsx)("h1",{children:"Notebooks"}),l.length?(0,r.jsx)("h2",{className:"header",children:"Recently viewed"}):null,(0,r.jsx)("div",{className:"doc-icons-container",children:l&&!e?(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsx)(DocIcon,{doc:e,onClick:archiveToggle,recentlyViewed:!0},e.doc_id))}):(0,r.jsx)("div",{children:"Loading recently viewed docs..."})}),(0,r.jsx)("h2",{className:"header",children:"Your notebooks"}),(0,r.jsx)("div",{className:"doc-icons-container",children:a&&!e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(DocIcon,{addDocIcon:!0}),a.map(e=>(0,r.jsx)(DocIcon,{doc:e,onClick:archiveToggle},e.doc_id))]}):(0,r.jsx)("div",{children:"Loading docs..."})}),0===u.length?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(p.default,{bordered:!1,size:"small",rootClassName:"archived-collapse",items:[{label:"Archived notebooks",key:"archived-docs",children:(0,r.jsx)("div",{className:"doc-icons-container",children:u.map(e=>(0,r.jsx)(DocIcon,{doc:e,onClick:archiveToggle},e.doc_id))})}]})})]})]})}}},function(e){e.O(0,[391,456,958,287,774,888,179],function(){return e(e.s=84308)}),_N_E=e.O()}]);