(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[444],{34376:function(e,t,s){e.exports=s(84142)},4139:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/manage-users",function(){return s(78977)}])},31143:function(e,t,s){"use strict";var a=s(28598),n=s(1887),r=s.n(n);t.Z=()=>(0,a.jsxs)(r(),{children:[(0,a.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,a.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},62429:function(e,t,s){"use strict";var a=s(28598),n=s(82684),r=s(91568),o=s(79869);t.Z=e=>{let{id:t,userType:s,children:i}=e,{Content:l,Sider:d}=o.Layout,[u,c]=(0,n.useState)([]),[h,f]=(0,n.useContext)(r._),logout=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),f({user:null,token:null,userType:null}),window.location.href="/login"};return(0,n.useEffect)(()=>{c("admin"==s?[{key:"manage-database",title:"Manage Database",icon:(0,a.jsx)("a",{href:"/extract-metadata",children:"\uD83D\uDCBE Manage DB"})},{key:"manage-users",title:"Manage Users",icon:(0,a.jsx)("a",{href:"/manage-users",children:"\uD83D\uDD10 Manage Users"})},{key:"view-notebook",title:"View your notebook",icon:(0,a.jsx)("a",{href:"/view-notebooks",children:"\uD83D\uDCD2 Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,a.jsx)("a",{href:"#",onClick:logout,children:"â†ª Logout"})}]:[{key:"view-notebook",title:"View your notebook",icon:(0,a.jsx)("a",{href:"/view-notebooks",children:"Your Notebooks"})},{key:"logout",title:"Logout",icon:(0,a.jsx)("a",{href:"#",onClick:logout,children:"Logout"})}])},[s]),(0,a.jsx)(o.Layout,{style:{height:"100vh"},children:(0,a.jsxs)(l,{children:[(0,a.jsx)(d,{style:{height:"100vh",position:"fixed"},children:(0,a.jsx)(o.v2,{style:{width:200,paddingTop:"2em",paddingBottom:"2em"},mode:"inline",selectedKeys:[t],items:u})}),(0,a.jsx)("div",{style:{paddingLeft:240,paddingTop:30,backgroundColor:"#f5f5f5"},children:i})]})})}},78977:function(e,t,s){"use strict";s.r(t);var a=s(28598),n=s(82684),r=s(34376),o=s(91568),i=s(31143),l=s(62429),d=s(37490),u=s(92696),c=s(85439),h=s(33612),f=s(10998),g=s(20259),m=s.n(g),y=s(35575),p=s(18953);t.default=()=>{let[e,t]=(0,n.useState)(!1),[s,g]=(0,n.useState)([]),[x,j]=(0,n.useContext)(o._),k=(0,r.useRouter)(),getUserDets=async()=>{if(!x.token)return;let e=await fetch("http://".concat("localhost:80","/admin/get_users"),{method:"POST",body:JSON.stringify({token:x.token}),headers:{"Content-Type":"application/json"}}),t=await e.json();t.users?g(t.users):p.default.error("There was an error fetching the user data. Please try again.")};return(0,n.useEffect)(()=>{let e=x.token,t=x.userType;if(!t){let s=localStorage.getItem("defogUser");if(e=localStorage.getItem("defogToken"),t=localStorage.getItem("defogUserType"),!s||!e||!t){k.push("/login");return}j({user:s,token:e,userType:t})}e?getUserDets():k.push("/login")},[x,x.token]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{}),(0,a.jsxs)(l.Z,{id:"manage-users",userType:"admin",children:[(0,a.jsx)("h1",{children:"Add New Users"}),(0,a.jsxs)(d.default,{gutter:{xs:8,sm:16,md:24,lg:32},children:[(0,a.jsxs)(u.default,{span:{xs:24,md:12},children:[(0,a.jsx)("h2",{children:"Add Users"}),(0,a.jsx)("p",{children:"Paste in user details as a CSV file with the headers: `username,password,user_type`"}),(0,a.jsxs)(c.default,{name:"add-users",disabled:e,onFinish:async e=>{t(!0);let s=await fetch("http://".concat("localhost:80","/admin/add_users"),{method:"POST",body:JSON.stringify({...e,token:x.token}),headers:{"Content-Type":"application/json"}}),a=await s.json();"success"===a.status?p.default.success("Users added successfully! Refreshing the user data..."):p.default.error("There was an error adding the users. Please try again."),await getUserDets(),t(!1)},children:[(0,a.jsx)(c.default.Item,{label:"CSV String",name:"user_dets_csv",children:(0,a.jsx)(h.default.TextArea,{})}),(0,a.jsx)(c.default.Item,{children:(0,a.jsx)(m(),{type:"primary",htmlType:"submit",children:"Add Users"})})]})]}),(0,a.jsxs)(u.default,{span:{xs:24,md:12},children:[(0,a.jsx)("h2",{children:"Users"}),(0,a.jsx)(f.default,{dataSource:s,columns:[{title:"User ID",dataIndex:"username",key:"username"},{title:"User Type",dataIndex:"user_type",key:"user_type"},{title:"Delete User",key:"delete_user",render:(e,s)=>(0,a.jsx)(y.default,{size:"middle",children:(0,a.jsx)("a",{onClick:async()=>{t(!0);let e=await fetch("http://".concat("localhost:80","/admin/delete_user"),{method:"POST",body:JSON.stringify({username:s.username,token:x.token}),headers:{"Content-Type":"application/json"}}),a=await e.json();"success"===a.status?p.default.success("User deleted successfully! Refreshing the user data..."):p.default.error("There was an error deleting the user. Please try again."),await getUserDets(),t(!1)},children:"Delete"})})}]})]})]})]})]})}}},function(e){e.O(0,[456,958,774,888,179],function(){return e(e.s=4139)}),_N_E=e.O()}]);