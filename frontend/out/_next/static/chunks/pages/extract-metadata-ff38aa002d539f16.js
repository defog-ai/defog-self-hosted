(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{9977:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/extract-metadata",function(){return t(9641)}])},6389:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});var r=t(5105),s=t(9035),n=t.n(s);let l=()=>(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,r.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},3360:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(5105),s=t(8101),n=t(3472),l=t(6665),o=t(6159),d=t(4799);let i=e=>{let{id:a,userType:t,children:i,rootClassNames:c="",contentClassNames:m="max-h-full h-full",containerClassNames:u="flex flex-col md:min-h-screen relative container mx-auto"}=e,[p,h]=(0,s.useState)([]),x=(0,n.useRouter)(),b=e=>{x.push(e)},y=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),b("/log-in")},g=(0,o.usePathname)();return(0,s.useEffect)(()=>{h(("admin"==t?[{title:"Admin",href:"#!",children:[{key:"manage-database",title:"Manage Database",href:"/extract-metadata"},{key:"manage-users",title:"Manage Users",href:"/manage-users"},{key:"align-model",title:"Align Model",href:"/align-model"},{key:"evaluate-model",title:"Evaluate Model",href:"/evaluate-model"}]},{key:"query-data",title:"Query Data",href:"/query-data"},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:y}]:t?[{key:"query-data",title:"Query Data",href:"/query-data"},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:y}]:[]).map(e=>(e.current=e.href==g,e)).map(e=>(e.children&&(e.children=e.children.map(e=>(e.current=e.href==g,e))),e)))},[t]),(0,r.jsxs)("div",{className:(0,d.QP)(u,c),children:[p.length?(0,r.jsx)(l.jq,{rootClassNames:(0,d.QP)("border-b dark:border-dark-border","bg-white dark:bg-dark-bg-primary","text-primary-text dark:text-dark-text-primary"),items:p.map(e=>({...e,classNames:(0,d.QP)(e.classNames,"hover:bg-gray-100 dark:hover:bg-dark-hover",e.current&&"bg-gray-100 dark:bg-dark-hover")}))}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)("div",{className:m,children:i})]})}},9641:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>Q});var r=t(5105),s=t(8101),n=t(6389),l=t(6173),o=t(1255),d=t(869),i=t(9692),c=t(4379),m=t(6665),u=t(2889),p=t.n(u);let h=e=>{let{token:a,dbInfo:t,onUpdate:n=()=>{}}=e,[u,h]=(0,s.useState)(t.tables||[]),[x,b]=(0,s.useState)(t.selected_tables||[]),[y,g]=(0,s.useState)((null==t?void 0:t.metadata)||[]),[f,k]=(0,s.useState)({}),[v,w]=(0,s.useState)(!1),j=t.db_name,N=(0,s.useContext)(m.oS);(0,s.useEffect)(()=>{g((null==t?void 0:t.metadata)||[]),h((null==t?void 0:t.tables)||[]),b((null==t?void 0:t.selected_tables)||[])},[t]);let _=(0,s.useCallback)(p()(async e=>{try{let t=await fetch((0,c.A)("http","integration/update_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({metadata:e,token:a,db_name:j})});if(!t.ok)throw Error("Error updating metadata");let r=await t.json();n(j,r),N.success("Metadata updated successfully")}catch(e){N.error("Error updating metadata:")}},500),[j]),C=(e,a)=>{let t=e.target.value,r=y.map(e=>"".concat(e.table_name,"_").concat(e.column_name)===a?{...e,column_description:t}:e);g(r),_(r)},S=(0,s.useMemo)(()=>[{label:"All tables",value:"all"},{label:"Clear all",value:"clear"},...t.tables.map(e=>({label:e,value:e}))],[t]),A=async()=>{console.log("Received tables: ",x),w(!0);try{N.info("Scanning selected tables.");let e=await fetch((0,c.A)("http","integration/generate_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:x,token:a,db_name:j})});if(!e.ok)throw Error("Could not extract metadata from tables");let t=await e.json();n(j,t)}catch(e){console.log(e),N.error("Error fetching metadata - please look at your docker logs for more information.")}finally{w(!1)}},E=[{title:"Table Name",dataIndex:"table_name",key:"table_name",width:"20%",align:"left",render:e=>(0,r.jsx)("span",{className:"p-2 font-bold",children:e})},{title:"Column Name",dataIndex:"column_name",key:"column_name",width:"20%",align:"left",render:e=>(0,r.jsx)("span",{className:"p-2 font-semibold",children:e})},{title:"Data Type",dataIndex:"data_type",key:"data_type",width:"20%",align:"left",render:e=>(0,r.jsx)("span",{className:"p-2 font-mono",children:e})},{title:"Description (Edit to update)",dataIndex:"column_description",key:"column_description",width:"35%",align:"left",render:(e,a)=>{let t="".concat(a.table_name,"_").concat(a.column_name);return(0,r.jsx)(m.fs,{defaultValue:e,autoResize:!0,defaultRows:1,onChange:e=>C(e,t),textAreaClassNames:"resize-none outline-transparent shadow-none"})}}],T=y.map(e=>({key:"".concat(e.table_name,"_").concat(e.column_name),...e})),O=async()=>{let e=await fetch((0,c.A)("http","integration/get_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,db_name:j,format:"csv"})}),t=await e.json();if(t.error)N.error(t.error);else{let e=window.URL.createObjectURL(new Blob([t.metadata])),a=document.createElement("a");a.href=e,a.setAttribute("download","metadata.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},D=async()=>{let e=document.createElement("input");e.type="file",e.accept=".csv",e.onchange=async e=>{let t=e.currentTarget.files[0],r=new FileReader;r.onload=async e=>{let t=e.target.result,r=await fetch((0,c.A)("http","integration/upload_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,db_name:j,metadata_csv:t})});if(r.ok)n(j,await r.json()),N.success("Metadata uploaded successfully!");else{N.error("Error uploading metadata");return}},r.readAsText(t)},w(!0),e.click(),w(!1)};return v?(0,r.jsxs)("div",{className:"relative space-y-4",children:[(0,r.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/70 dark:bg-gray-900/70 backdrop-blur-[1px]",children:[(0,r.jsx)(m.c5,{classNames:"text-blue-500 h-6 w-6"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-300",children:"Fetching metadata..."})]}),(0,r.jsx)("div",{className:"pointer-events-none",children:(0,r.jsx)("div",{className:"space-y-2 p-4",children:(0,r.jsx)("div",{className:"text-lg font-medium text-center dark:text-dark-text-primary",children:"View and Update Metadata"})})})]}):(0,r.jsxs)("div",{className:"space-y-10",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center text-blue-500 rounded-lg dark:text-blue-300 gap-2 text-sm",children:[(0,r.jsx)(l.A,{}),"Extracting table and column metadata helps our AI generate more accurate SQL queries."]}),(0,r.jsxs)("div",{className:"flex flex-row items-start gap-2 w-full border-b pb-10",children:[u&&(0,r.jsx)(m.KF,{placeholder:"Select tables for metadata extraction. Leave empty to process all tables.",options:S,value:x,allowCreateNewOption:!1,onChange:e=>{if(e.indexOf("all")>-1){b(u);return}if(e.indexOf("clear")>-1){b([]);return}b(e)},rootClassNames:"max-w-full grow"}),(0,r.jsxs)(m.$n,{onClick:A,disabled:v,variant:"primary",className:"flex flex-col gap-2 min-h-full",children:[(0,r.jsx)(o.A,{}),"Extract AI Metadata"]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium dark:text-dark-text-primary",children:"Current Metadata"}),(0,r.jsx)(m.XI,{rootClassNames:"!p-0",columns:E,rows:T,pagination:{defaultPageSize:10,showSizeChanger:!0},paginationPosition:"bottom",rowCellRender:e=>{let{cellValue:a,row:t,dataIndex:s,column:n}=e;return"function"==typeof n.render?(0,r.jsx)("td",{className:"px-3 py-2 align-top text-sm text-gray-700 dark:text-gray-200",children:n.render(a,t)},"".concat(t.key,"-").concat(s)):(0,r.jsx)("td",{className:"px-3 py-2  align-top text-sm text-gray-700 dark:text-gray-200",children:a},"".concat(t.key,"-").concat(s))}}),(0,r.jsxs)("div",{className:"flex justify-center my-4 gap-4",children:[(0,r.jsxs)(m.$n,{disabled:v,onClick:O,children:[(0,r.jsx)("span",{children:"Download"})," ",(0,r.jsx)(d.A,{className:"h-4 w-4"})]}),(0,r.jsxs)(m.$n,{disabled:v,onClick:D,children:[(0,r.jsx)("span",{children:"Upload"})," ",(0,r.jsx)(i.A,{className:"h-4 w-4"})]})]})]})]})};var x=t(3360),b=t(576),y=t.n(b),g=t(9964);let f=async(e,a)=>{let t=await fetch((0,c.A)("http","integration/get_db_info"),{method:"POST",body:JSON.stringify({token:e,db_name:a}),headers:{"Content-Type":"application/json"}});if(t.ok)return await t.json();throw Error("Failed to get tables and db creds")},k=async(e,a)=>{let t=await fetch((0,c.A)("http","integration/delete_db_info"),{method:"POST",body:JSON.stringify({token:e,db_name:a}),headers:{"Content-Type":"application/json"}});if(t.ok)return await t.json();throw Error("Failed to delete db info")},v={EXCEL:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",OLD_EXCEL:"application/vnd.ms-excel",CSV:"text/csv"},w=async(e,a,t)=>{let r=await fetch((0,c.A)("http","upload_file_as_db"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e,file_name:a,tables:t})});if(!r.ok)throw Error("Failed to create new api key name - are you sure your network is working?");let s=await r.json();return{dbName:s.db_name,dbInfo:s.db_info}};function j(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t]};if("text/csv"!==e.type)throw Error("File type must be CSV");y().parse(e,{dynamicTyping:!0,skipEmptyLines:!0,header:!0,complete:t=>{let r=t.meta.fields.map(e=>({title:e,dataIndex:e,key:e})),s=t.data;s.forEach((e,a)=>{e.key=a}),a({file:e,rows:s,columns:r})}})}async function N(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t]},t=await e.arrayBuffer(),r=(0,g.LF)(t),s={};r.SheetNames.forEach(e=>{let a=g.Wp.sheet_to_json(r.Sheets[e],{defval:null}),t=Object.keys(a[0]).map(e=>({title:e,dataIndex:e,key:e}));s[e]={rows:a,columns:t}}),a({file:e,sheets:s})}let _={postgres:["host","port","user","password","database"],redshift:["host","port","user","password","database","schema"],snowflake:["account","warehouse","user","password"],databricks:["server_hostname","access_token","http_path","schema"],bigquery:["credentials_file_content"],sqlserver:["server","database","user","password"]},C={host:"host.docker.internal",port:"5432",user:"Database User",database:"Database Name",server_hostname:"Server Hostname",access_token:"Access Token",http_path:"HTTP Path",schema:"Schema"},S={db_name:"",db_type:"postgres",db_creds:{host:"",port:"",user:"",password:"",database:""}},A=e=>{let{token:a="",existingDbInfo:t=null,onDbUpdatedOrCreated:n=()=>{}}=e,[l,o]=(0,s.useState)(!1),d=(0,s.useContext)(m.oS),[i,u]=(0,s.useState)({...S,...t});(0,s.useEffect)(()=>{t&&u({...S,...t})},[t]);let p=async e=>{e.preventDefault();let t={token:a,db_name:i.db_name,db_type:i.db_type,db_creds:i.db_creds};try{o(!0);let e=await fetch((0,c.A)("http","integration/update_db_creds"),{method:"POST",body:JSON.stringify(t)});if(!e.ok)throw Error("Could not update db creds");let a=await e.json();n(a.db_name,a)}catch(e){console.log(e),d.error(e.message)}finally{o(!1)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(m.pd,{label:"Database nickname "+(t?"":"(This is for your reference so make it memorable. This cannot be changed later!)"),status:t&&(null==i?void 0:i.db_name)!==(null==t?void 0:t.db_name)?"error":null,type:"text",name:"db_name",value:(null==i?void 0:i.db_name)||"",onChange:e=>{u({...i,db_name:e.target.value})},disabled:t&&!0}),(0,r.jsx)(m.Z,{rootClassNames:"not-prose",allowClear:!1,label:"Database Type",value:(null==i?void 0:i.db_type)||"postgres",options:[{value:"postgres",label:"PostgreSQL"},{value:"redshift",label:"Amazon Redshift"},{value:"snowflake",label:"Snowflake"},{value:"databricks",label:"Databricks"},{value:"bigquery",label:"Google BigQuery"},{value:"sqlserver",label:"Microsoft SQL Server"}],onChange:e=>{u({...i,db_type:e})}}),(null==i?void 0:i.db_type)&&_[i.db_type].map(e=>{var a;return(0,r.jsx)("div",{children:(0,r.jsx)(m.pd,{label:e.charAt(0).toUpperCase()+e.slice(1),type:"password"===e?"password":"text",name:e,value:(null===(a=i.db_creds)||void 0===a?void 0:a[e])||"",onChange:a=>{u({...i,db_creds:{...i.db_creds,[e]:a.target.value}})},placeholder:C[e]||"Enter ".concat(e)})},e)}),(0,r.jsx)(m.$n,{onClick:p,className:"w-full justify-center p-2",variant:"primary",disabled:l||!i.db_name,children:l?"Updating...":t?"Update":"Create"})]})})};var E=t(3270),T=t(9783),O=t(8756),D=t(1610);let I=e=>{let{loading:a,canConnect:t,areTablesIndexed:s,hasNonEmptyDescription:n}=e,l=[{key:"1",title:"Database Setup",description:a?(0,r.jsx)(E.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):t?"Database connection verified":"We could not connect to your database. Please check your connection details.",status:a?(0,r.jsx)(E.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):t?(0,r.jsx)(T.A,{className:"text-[#96c880] h-5 w-5"}):(0,r.jsx)(O.A,{className:"text-[#fc8e8e] h-5 w-5"})},{key:"2",title:"Metadata Setup",description:a?(0,r.jsx)(E.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):s?"AI metadata generated for at least one table":"AI metadata not generated. Queries will be incorrect.",status:a?(0,r.jsx)(E.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):s?(0,r.jsx)(T.A,{className:"text-[#96c880] h-5 w-5"}):(0,r.jsx)(D.A,{className:"text-yellow-500 h-5 w-5"}),blur:!t},{key:"3",title:"Column Descriptions",description:a?(0,r.jsx)(E.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):n?"We found at least one column with a description. You can view and update the metadata.":"We did not find any column descriptions. Queries will be incorrect.",status:a?(0,r.jsx)(E.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):n?(0,r.jsx)(T.A,{className:"text-[#96c880] h-5 w-5"}):(0,r.jsx)(D.A,{className:"text-yellow-500 h-5 w-5"}),blur:!t}];return(0,r.jsx)("div",{className:"mt-4 flex flex-row gap-4",children:l.map(e=>(0,r.jsx)("div",{className:"w-1/3 ".concat(e.blur?"filter blur-sm pointer-events-none opacity-60":""),children:(0,r.jsxs)("div",{className:"h-full bg-white dark:bg-dark-bg-secondary border border-gray-200 dark:border-dark-border rounded-lg",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-dark-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between dark:text-dark-text-primary",children:[(0,r.jsx)("span",{className:"text-base font-medium",children:e.title}),(0,r.jsx)("span",{children:e.status})]})}),(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsx)("p",{className:"text-gray-600 dark:text-dark-text-secondary text-sm",children:e.description})})]})},e.key))})};var P=t(774),U=t(3196);function F(e){let{token:a,onCreated:t=()=>{}}=e,n=(0,s.useContext)(m.oS),l=[{name:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(P.A,{className:"w-4"}),"Connect Database"]}),content:(0,r.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[(0,r.jsx)("h3",{children:"Connect your database"}),(0,r.jsx)("p",{children:"Connect directly to your existing database to unlock AI-powered insights."}),(0,r.jsx)(A,{token:a,onDbUpdatedOrCreated:(e,a)=>{t(e,a)}})]})},{name:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(U.A,{className:"w-4"}),"Upload CSV/Excel"]}),content:(0,r.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[(0,r.jsx)("h3",{children:"Upload data file"}),(0,r.jsx)("p",{children:"Don't have direct database access? Upload your CSV or Excel file to get started quickly."}),(0,r.jsx)(m.z8,{showIcon:!0,rootClassNames:"min-h-96 max-w-none border dark:border-gray-700  flex flex-col items-center justify-center bg-gray-50  dark:bg-gray-700 text-gray-400 dark:text-gray-200 p-4 w-full",labelClassNames:"text-gray-400 dark:text-gray-200 text-sm",iconClassNames:"m-auto text-gray-400 text-sm",label:"Drag and drop your file here, or",onFileSelect:async e=>{e.preventDefault(),e.stopPropagation();try{var r;let s=e.target.files[0];if(!s||(r=s.type,!Object.values(v).includes(r)))throw Error("Only CSV or Excel files are accepted");"text/csv"===s.type?j(s,async e=>{let{file:r,rows:s,columns:n}=e;try{let{dbName:e,dbInfo:l}=await w(a,r.name,{[r.name]:{rows:s,columns:n}}).catch(e=>{throw e});t(e,l)}catch(e){throw e}}):N(s,async e=>{let{file:r,sheets:s}=e;try{let{dbName:e,dbInfo:n}=await w(a,r.name,s).catch(e=>{throw e});t(e,n)}catch(e){throw e}})}catch(e){console.error(e),n.error("Failed to parse the file")}},onDrop:async e=>{e.preventDefault(),e.stopPropagation();try{var r,s;let n=null==e?void 0:null===(s=e.dataTransfer)||void 0===s?void 0:null===(r=s.items)||void 0===r?void 0:r[0];if(!n||!n.kind||"file"!==n.kind)throw Error("Invalid file");let l=n.getAsFile();"text/csv"===l.type?j(l,async e=>{let{file:r,rows:s,columns:n}=e;try{let{dbName:e,dbInfo:l}=await w(a,r.name,{[r.name]:{rows:s,columns:n}}).catch(e=>{throw e});t(e,l)}catch(e){throw e}}):N(l,async e=>{let{file:r,sheets:s}=e;try{let{dbName:e,dbInfo:n}=await w(a,r.name,s).catch(e=>{throw e});t(e,n)}catch(e){throw e}})}catch(e){n.error(e.message||"Failed to parse the file"),console.log(e.stack)}finally{}}})]})}];return(0,r.jsx)(m.tU,{tabs:l})}var L=t(2233),M=t(4412),R=t(9247),q=t(3184);let Q=()=>{var e;let[a,t]=(0,s.useState)({}),[l,o]=(0,s.useState)(null),d=(0,s.useRef)(""),[i,c]=(0,s.useState)(!0),u=(0,s.useContext)(m.oS);(0,s.useEffect)(()=>{d.current=localStorage.getItem("defogToken"),(async()=>{c(!0);try{let e=await fetch((q.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")+"/get_db_names",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:d})});if(!e.ok)throw Error("Failed to get api key names - are you sure your network is working?");let a=await e.json(),r=a.db_names.filter(e=>e),s={};for(let e of r){let a=await f(d.current,e);s[e]=a}o(a.db_names.length?a.db_names[0]:null),c(!1),t(s)}catch(e){u.error(e.message),console.error(e)}})()},[]);let p=a[l]&&a[l].tables&&a[l].tables.length>0,b=a[l]&&a[l].metadata&&a[l].metadata.some(e=>e.column_description&&""!==e.column_description.trim()),y=null===(e=a[l])||void 0===e?void 0:e.can_connect,g=(0,s.useId)(),v=(0,s.useMemo)(()=>{if(!Object.keys(a).length)return null;let e=Object.keys(a).map(e=>({value:e,label:e}));return e=[{value:g,label:"Add new database"},...e],(0,r.jsx)("div",{className:"flex flex-row my-6 w-full gap-2 items-center",children:Object.keys(a).length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{label:"Select database",labelClassNames:"font-bold text-sm",allowClear:!1,allowCreateNewOption:!1,options:e,value:l||void 0,onChange:e=>o(e),placeholder:"Select your DB name",optionRenderer:e=>e.value===g?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(L.A,{className:"w-4"}),"Add new database"]}):(0,r.jsxs)("div",{className:"whitespace-pre flex items-center gap-2",children:[(0,r.jsx)(M.A,{className:"w-4"}),e.label]})}),l!==g&&(0,r.jsx)(R.A,{className:"w-5 h-5 relative top-3 cursor-pointer hover:text-rose-500",onClick:()=>{try{k(d.current,l),u.success("Database deleted"),t(e=>{let a={...e};return delete a[l],a}),o(g)}catch(e){console.error(e),u.error("Failed to delete database")}}})]})})},[l]),w=(0,s.useMemo)(()=>!l||l===g||i?null:[{name:"Database Connection",content:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(A,{token:d.current,existingDbInfo:a[l],onDbUpdatedOrCreated:(e,a)=>{o(e),t(t=>({...t,[e]:a}))}})})},{name:"AI Metadata Management",content:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(h,{token:d.current,dbInfo:a[l],onUpdate:(e,a)=>{t(t=>({...t,[e]:a}))}})})}],[i,l,a]);return i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{}),(0,r.jsx)(x.A,{id:"manage-database",userType:"admin",children:(0,r.jsxs)("div",{className:"w-full h-96 text-gray-500 dark:bg-dark-bg-primary flex items-center justify-center",children:[(0,r.jsx)(m.c5,{}),"Loading"]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{}),(0,r.jsx)(x.A,{id:"manage-database",userType:"admin",children:(0,r.jsxs)("div",{className:"w-full dark:bg-dark-bg-primary px-2 md:px-0",children:[v,Object.keys(a).length&&w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I,{loading:i,canConnect:y,areTablesIndexed:p,hasNonEmptyDescription:b}),(0,r.jsx)("div",{className:"dark:bg-dark-bg-primary mt-4",children:(0,r.jsx)(m.tU,{rootClassNames:"w-full dark:bg-dark-bg-primary min-h-[500px]",tabs:w.map(e=>({...e,className:"!overflow-y-visible dark:bg-dark-bg-primary dark:text-dark-text-primary dark:hover:bg-dark-hover dark:border-dark-border",selectedClassName:"dark:bg-dark-hover dark:text-dark-text-primary dark:border-b-2 dark:border-blue-500"})),disableSingleSelect:!0,contentClassNames:"border dark:border-gray-700 border-t-none"})})]}):(0,r.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[0===Object.keys(a).length&&(0,r.jsxs)("div",{className:"max-w-lg mx-auto text-center my-10",children:[(0,r.jsx)("h3",{children:"Welcome to Defog!"}),(0,r.jsx)("p",{children:"Let's get you set up with your first database connection. Connect your data source to start generating AI-powered SQL queries and reports."})]}),(0,r.jsx)(F,{token:d.current,onCreated:(e,a)=>{t(t=>({...t,[e]:a})),o(e),u.success("Database ".concat(e," created successfully"))}})]})]})})]})}},4379:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});var r=t(3184);let s=(e,a)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return""!==a?"ws"===e?"".concat((r.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"").replace("http","ws"),"/").concat(a):"".concat(r.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"","/").concat(a):"".concat(r.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")}},7615:()=>{},9972:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[159,328,351,869,636,593,792],()=>a(9977)),_N_E=e.O()}]);