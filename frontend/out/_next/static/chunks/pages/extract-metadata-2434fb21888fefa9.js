(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{5495:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/extract-metadata",function(){return t(9221)}])},2427:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});var r=t(5105),s=t(761),n=t.n(s);let l=()=>(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:"Defog.ai - AI Assistant for Data Analysis"}),(0,r.jsx)("meta",{name:"description",content:"Train your AI data assistant on your own device"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]})},2678:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(5105),s=t(8101),n=t(5922),l=t(4462),o=t(5337),d=t(4799);let i=e=>{let{id:a,userType:t,children:i,rootClassNames:c="",contentClassNames:m="max-h-full h-full",containerClassNames:u="flex flex-col md:min-h-screen relative container mx-auto"}=e,[p,h]=(0,s.useState)([]),x=(0,n.useRouter)(),b=e=>{x.push(e)},f=()=>{localStorage.removeItem("defogUser"),localStorage.removeItem("defogToken"),localStorage.removeItem("defogUserType"),b("/log-in")},g=(0,o.usePathname)();return(0,s.useEffect)(()=>{h(("admin"==t?[{title:"Admin",href:"#!",children:[{key:"manage-database",title:"Manage Database",href:"/extract-metadata"},{key:"manage-users",title:"Manage Users",href:"/manage-users"},{key:"align-model",title:"Align Model",href:"/align-model"}]},{key:"query-data",title:"Query Data",href:"/query-data"},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:f}]:t?[{key:"query-data",title:"Query Data",href:"/query-data"},{key:"reports",title:"Reports",href:"/reports"},{key:"logout",classNames:"self-end",title:"Logout",href:"#",onClick:f}]:[]).map(e=>(e.current=e.href==g,e)).map(e=>(e.children&&(e.children=e.children.map(e=>(e.current=e.href==g,e))),e)))},[t]),(0,r.jsxs)("div",{className:(0,d.QP)(u,c),children:[p.length?(0,r.jsx)(l.jq,{rootClassNames:(0,d.QP)("border-b dark:border-dark-border","bg-white dark:bg-dark-bg-primary","text-primary-text dark:text-dark-text-primary"),items:p.map(e=>({...e,classNames:(0,d.QP)(e.classNames,"hover:bg-gray-100 dark:hover:bg-dark-hover",e.current&&"bg-gray-100 dark:bg-dark-hover")}))}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)("div",{className:m,children:i})]})}},9221:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>R});var r=t(5105),s=t(8101),n=t(2427),l=t(5123),o=t(6769),d=t(6095),i=t(3106),c=t(9157),m=t(4462),u=t(2889),p=t.n(u);let h=e=>{let{token:a,dbInfo:t,onUpdate:n=()=>{}}=e,[u,h]=(0,s.useState)(t.tables||[]),[x,b]=(0,s.useState)(t.selected_tables||[]),[f,g]=(0,s.useState)((null==t?void 0:t.metadata)||[]),[y,k]=(0,s.useState)({}),[v,j]=(0,s.useState)(!1),w=t.db_name,N=(0,s.useContext)(m.oS);(0,s.useEffect)(()=>{g((null==t?void 0:t.metadata)||[]),h((null==t?void 0:t.tables)||[]),b((null==t?void 0:t.selected_tables)||[])},[t]);let _=(0,s.useCallback)(p()(async e=>{try{let t=await fetch((0,c.A)("http","integration/update_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({metadata:e,token:a,db_name:w})});if(!t.ok)throw Error("Error updating metadata");let r=await t.json();n(w,r),N.success("Metadata updated successfully")}catch(e){N.error("Error updating metadata:")}},500),[w]),C=(e,a)=>{let t=e.target.value,r=f.map(e=>"".concat(e.table_name,"_").concat(e.column_name)===a?{...e,column_description:t}:e);g(r),_(r)},S=(0,s.useMemo)(()=>[{label:"All tables",value:"all"},{label:"Clear all",value:"clear"},...t.tables.map(e=>({label:e,value:e}))],[t]),A=async()=>{console.log("Received tables: ",x),j(!0);try{N.info("Scanning selected tables.");let e=await fetch((0,c.A)("http","integration/generate_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:x,token:a,db_name:w})});if(!e.ok)throw Error("Could not extract metadata from tables");let t=await e.json();n(w,t)}catch(e){console.log(e),N.error("Error fetching metadata - please look at your docker logs for more information.")}finally{j(!1)}},E=[{title:"Table Name",dataIndex:"table_name",key:"table_name",width:"20%",align:"left",render:e=>(0,r.jsx)("span",{className:"p-2 font-bold",children:e})},{title:"Column Name",dataIndex:"column_name",key:"column_name",width:"20%",align:"left",render:e=>(0,r.jsx)("span",{className:"p-2 font-semibold",children:e})},{title:"Data Type",dataIndex:"data_type",key:"data_type",width:"20%",align:"left",render:e=>(0,r.jsx)("span",{className:"p-2 font-mono",children:e})},{title:"Description (Edit to update)",dataIndex:"column_description",key:"column_description",width:"35%",align:"left",render:(e,a)=>{let t="".concat(a.table_name,"_").concat(a.column_name);return(0,r.jsx)(m.fs,{defaultValue:e,autoResize:!0,defaultRows:1,onChange:e=>C(e,t),textAreaClassNames:"resize-none outline-transparent shadow-none"})}}],T=f.map(e=>({key:"".concat(e.table_name,"_").concat(e.column_name),...e})),O=async()=>{let e=await fetch((0,c.A)("http","integration/get_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,db_name:w,format:"csv"})}),t=await e.json();if(t.error)N.error(t.error);else{let e=window.URL.createObjectURL(new Blob([t.metadata])),a=document.createElement("a");a.href=e,a.setAttribute("download","metadata.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},D=async()=>{let e=document.createElement("input");e.type="file",e.accept=".csv",e.onchange=async e=>{let t=e.currentTarget.files[0],r=new FileReader;r.onload=async e=>{let t=e.target.result,r=await fetch((0,c.A)("http","integration/upload_metadata"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,db_name:w,metadata_csv:t})});if(r.ok)n(w,await r.json()),N.success("Metadata uploaded successfully!");else{N.error("Error uploading metadata");return}},r.readAsText(t)},j(!0),e.click(),j(!1)};return v?(0,r.jsxs)("div",{className:"relative space-y-4",children:[(0,r.jsxs)("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/70 dark:bg-gray-900/70 backdrop-blur-[1px]",children:[(0,r.jsx)(m.c5,{classNames:"text-blue-500 h-6 w-6"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-300",children:"Fetching metadata..."})]}),(0,r.jsx)("div",{className:"pointer-events-none",children:(0,r.jsx)("div",{className:"space-y-2 p-4",children:(0,r.jsx)("div",{className:"text-lg font-medium text-center dark:text-dark-text-primary",children:"View and Update Metadata"})})})]}):(0,r.jsxs)("div",{className:"space-y-10",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center text-blue-500 rounded-lg dark:text-blue-300 gap-2 text-sm",children:[(0,r.jsx)(l.A,{}),"Extracting table and column metadata helps our AI generate more accurate SQL queries."]}),(0,r.jsxs)("div",{className:"flex flex-row items-start gap-2 w-full border-b pb-10",children:[u&&(0,r.jsx)(m.KF,{placeholder:"Select tables for metadata extraction. Leave empty to process all tables.",options:S,value:x,allowCreateNewOption:!1,onChange:e=>{if(e.indexOf("all")>-1){b(u);return}if(e.indexOf("clear")>-1){b([]);return}b(e)},rootClassNames:"max-w-full grow"}),(0,r.jsxs)(m.$n,{onClick:A,disabled:v,variant:"primary",className:"flex flex-col gap-2 min-h-full",children:[(0,r.jsx)(o.A,{}),"Extract AI Metadata"]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium dark:text-dark-text-primary",children:"Current Metadata"}),(0,r.jsx)(m.XI,{rootClassNames:"!p-0",columns:E,rows:T,pagination:{defaultPageSize:10,showSizeChanger:!0},paginationPosition:"bottom",rowCellRender:e=>{let{cellValue:a,row:t,dataIndex:s,column:n}=e;return"function"==typeof n.render?(0,r.jsx)("td",{className:"px-3 py-2 align-top text-sm text-gray-700 dark:text-gray-200",children:n.render(a,t)},"".concat(t.key,"-").concat(s)):(0,r.jsx)("td",{className:"px-3 py-2  align-top text-sm text-gray-700 dark:text-gray-200",children:a},"".concat(t.key,"-").concat(s))}}),(0,r.jsxs)("div",{className:"flex justify-center my-4 gap-4",children:[(0,r.jsxs)(m.$n,{disabled:v,onClick:O,children:[(0,r.jsx)("span",{children:"Download"})," ",(0,r.jsx)(d.A,{className:"h-4 w-4"})]}),(0,r.jsxs)(m.$n,{disabled:v,onClick:D,children:[(0,r.jsx)("span",{children:"Upload"})," ",(0,r.jsx)(i.A,{className:"h-4 w-4"})]})]})]})]})};var x=t(2678);let b=async(e,a)=>{let t=await fetch((0,c.A)("http","integration/get_db_info"),{method:"POST",body:JSON.stringify({token:e,db_name:a}),headers:{"Content-Type":"application/json"}});if(t.ok)return await t.json();throw Error("Failed to get tables and db creds")},f=async(e,a)=>{let t=await fetch((0,c.A)("http","integration/delete_db_info"),{method:"POST",body:JSON.stringify({token:e,db_name:a}),headers:{"Content-Type":"application/json"}});if(t.ok)return await t.json();throw Error("Failed to delete db info")},g={EXCEL:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",OLD_EXCEL:"application/vnd.ms-excel",CSV:"text/csv"};function y(e){return Object.values(g).find(a=>a===e)}let k={postgres:["host","port","user","password","database"],redshift:["host","port","user","password","database","schema"],snowflake:["account","warehouse","user","password"],databricks:["server_hostname","access_token","http_path","schema"],bigquery:["credentials_file_content"],sqlserver:["server","database","user","password"]},v={host:"host.docker.internal",port:"5432",user:"Database User",database:"Database Name",server_hostname:"Server Hostname",access_token:"Access Token",http_path:"HTTP Path",schema:"Schema"},j={db_name:"",db_type:"postgres",db_creds:{host:"",port:"",user:"",password:"",database:""}},w=e=>{let{token:a="",existingDbInfo:t=null,onDbUpdatedOrCreated:n=()=>{}}=e,[l,o]=(0,s.useState)(!1),d=(0,s.useContext)(m.oS),[i,u]=(0,s.useState)({...j,...t});(0,s.useEffect)(()=>{t&&u({...j,...t})},[t]);let p=async e=>{e.preventDefault();let t={token:a,db_name:i.db_name,db_type:i.db_type,db_creds:i.db_creds};try{o(!0);let e=await fetch((0,c.A)("http","integration/update_db_creds"),{method:"POST",body:JSON.stringify(t)});if(!e.ok)throw Error("Could not update db creds");let a=await e.json();n(a.db_name,a)}catch(e){console.log(e),d.error(e.message)}finally{o(!1)}};return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(m.pd,{label:"Database nickname "+(t?"":"(This is for your reference so make it memorable. This cannot be changed later!)"),status:t&&(null==i?void 0:i.db_name)!==(null==t?void 0:t.db_name)?"error":null,type:"text",name:"db_name",value:(null==i?void 0:i.db_name)||"",onChange:e=>{u({...i,db_name:e.target.value})},disabled:t&&!0}),(0,r.jsx)(m.Z,{rootClassNames:"not-prose",allowClear:!1,label:"Database Type",value:(null==i?void 0:i.db_type)||"postgres",options:[{value:"postgres",label:"PostgreSQL"},{value:"redshift",label:"Amazon Redshift"},{value:"snowflake",label:"Snowflake"},{value:"databricks",label:"Databricks"},{value:"bigquery",label:"Google BigQuery"},{value:"sqlserver",label:"Microsoft SQL Server"}],onChange:e=>{u({...i,db_type:e})}}),(null==i?void 0:i.db_type)&&k[i.db_type].map(e=>{var a;return(0,r.jsx)("div",{children:(0,r.jsx)(m.pd,{label:e.charAt(0).toUpperCase()+e.slice(1),type:"password"===e?"password":"text",name:e,value:(null===(a=i.db_creds)||void 0===a?void 0:a[e])||"",onChange:a=>{u({...i,db_creds:{...i.db_creds,[e]:a.target.value}})},placeholder:v[e]||"Enter ".concat(e)})},e)}),(0,r.jsx)(m.$n,{onClick:p,className:"w-full justify-center p-2",variant:"primary",disabled:l||!i.db_name,children:l?"Updating...":t?"Update":"Create"})]})})};var N=t(5656),_=t(8497),C=t(1826),S=t(260);let A=e=>{let{loading:a,canConnect:t,areTablesIndexed:s,hasNonEmptyDescription:n}=e,l=[{key:"1",title:"Database Setup",description:a?(0,r.jsx)(N.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):t?"Database connection verified":"We could not connect to your database. Please check your connection details.",status:a?(0,r.jsx)(N.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):t?(0,r.jsx)(_.A,{className:"text-[#96c880] h-5 w-5"}):(0,r.jsx)(C.A,{className:"text-[#fc8e8e] h-5 w-5"})},{key:"2",title:"Metadata Setup",description:a?(0,r.jsx)(N.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):s?"AI metadata generated for at least one table":"AI metadata not generated. Queries will be incorrect.",status:a?(0,r.jsx)(N.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):s?(0,r.jsx)(_.A,{className:"text-[#96c880] h-5 w-5"}):(0,r.jsx)(S.A,{className:"text-yellow-500 h-5 w-5"}),blur:!t},{key:"3",title:"Column Descriptions",description:a?(0,r.jsx)(N.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):n?"We found at least one column with a description. You can view and update the metadata.":"We did not find any column descriptions. Queries will be incorrect.",status:a?(0,r.jsx)(N.A,{className:"text-gray-500 dark:text-dark-text-primary h-5 w-5"}):n?(0,r.jsx)(_.A,{className:"text-[#96c880] h-5 w-5"}):(0,r.jsx)(S.A,{className:"text-yellow-500 h-5 w-5"}),blur:!t}];return(0,r.jsx)("div",{className:"mt-4 flex flex-row gap-4",children:l.map(e=>(0,r.jsx)("div",{className:"w-1/3 ".concat(e.blur?"filter blur-sm pointer-events-none opacity-60":""),children:(0,r.jsxs)("div",{className:"h-full bg-white dark:bg-dark-bg-secondary border border-gray-200 dark:border-dark-border rounded-lg",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-dark-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between dark:text-dark-text-primary",children:[(0,r.jsx)("span",{className:"text-base font-medium",children:e.title}),(0,r.jsx)("span",{children:e.status})]})}),(0,r.jsx)("div",{className:"px-6 py-4",children:(0,r.jsx)("p",{className:"text-gray-600 dark:text-dark-text-secondary text-sm",children:e.description})})]})},e.key))})};var E=t(5856),T=t(2822),O=t(4799);function D(e){let{token:a,uploadFile:t=()=>{}}=e,[n,l]=(0,s.useState)(!1),o=(0,s.useContext)(m.oS);return(0,r.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[(0,r.jsx)("h3",{children:"Upload data file"}),(0,r.jsx)("p",{children:"Don't have direct database access? Upload your CSV or Excel file to get started quickly."}),(0,r.jsxs)("div",{className:"h-96",children:[(0,r.jsx)(m.z8,{showIcon:!0,rootClassNames:(0,O.QP)("h-full",n?"hidden":""),label:"Drag and drop your file here, or",onFileSelect:async e=>{e.preventDefault(),e.stopPropagation();try{l(!0);let a=e.target.files[0];if(!a)return;if(!y(null==a?void 0:a.type))throw Error("Only CSV or Excel files are accepted");let r=performance.now(),s=await a.arrayBuffer(),n=performance.now();console.log("Conversion to buffer took",n-r,"milliseconds");try{o.info("Uploading your file"),t({fileName:a.name,fileBuffer:s})}catch(e){l(!1),o.error(e instanceof Error?e.message:String(e))}}catch(e){l(!1),o.error(e instanceof Error?e.message:String(e))}},onDrop:async e=>{e.preventDefault(),e.stopPropagation();try{var a,r;l(!0);let s=null==e?void 0:null===(r=e.dataTransfer)||void 0===r?void 0:null===(a=r.items)||void 0===a?void 0:a[0];if(!s||!s.kind||"file"!==s.kind)throw Error("Invalid file");if(!y(s.type))throw Error("Only CSV or Excel files are accepted");let n=s.getAsFile(),d=performance.now(),i=await n.arrayBuffer(),c=performance.now();console.log("Conversion to buffer took",c-d,"milliseconds");try{o.info("Uploading your file. It might take upto 5 minutes to create a db if the file is large"),t({fileName:n.name,fileBuffer:i})}catch(e){l(!1),o.error(e instanceof Error?e.message:String(e))}}catch(e){l(!1),o.error(e instanceof Error?e.message:String(e))}}}),n&&(0,r.jsxs)("div",{className:"border rounded-md dark:border-gray-700 text-xs min-h-96 flex w-full h-full items-center justify-center gap-1",children:[(0,r.jsx)(m.c5,{})," Uploading your file"]})]})]})}function P(e){let{token:a,uploadFile:t=()=>{},onCredsSubmit:n=()=>{}}=e,l=(0,s.useMemo)(()=>[{id:"connect-db",name:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(E.A,{className:"w-4"}),"Connect Database"]}),content:(0,r.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[(0,r.jsx)("h3",{children:"Connect your database"}),(0,r.jsx)("p",{children:"Connect directly to your existing database to unlock AI-powered insights."}),(0,r.jsx)(w,{token:a,onDbUpdatedOrCreated:(e,a)=>{n(e,a)}})]})},{id:"upload-file",name:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T.A,{className:"w-4"}),"Upload CSV/Excel"]}),content:(0,r.jsx)(D,{token:a,uploadFile:t})}],[]);return(0,r.jsx)(m.tU,{tabs:l})}var I=t(5911),U=t(1982),L=t(9445),F=t(6485);let R=()=>{var e;let[a,l]=(0,s.useState)({}),[o,d]=(0,s.useState)(null),i=(0,s.useRef)(""),[c,u]=(0,s.useState)(!0),[p,g]=(0,s.useState)(!1),y=(0,s.useContext)(m.oS),k=(0,s.useRef)(null);(0,s.useEffect)(()=>(k.current||(k.current=new Worker(t.tu(new URL(t.p+t.u(321),t.b)),{type:void 0}),k.current.onmessage=e=>{let{type:a,dbName:t,dbInfo:r,error:s}=e.data;"UPLOAD_SUCCESS"===a?(y.success("DB ".concat(t," created successfully")),l(e=>({...e,[t]:r})),d(t)):"UPLOAD_ERROR"===a&&y.error(s||"Failed to upload file"),g(!1)}),()=>{console.log("ubsubbing"),k.current&&(k.current.terminate(),k.current=null)}),[y]),(0,s.useEffect)(()=>{i.current=localStorage.getItem("defogToken"),(async()=>{u(!0);try{let e=await fetch((F.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")+"/get_db_names",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:i})});if(!e.ok)throw Error("Failed to get api key names - are you sure your network is working?");let a=await e.json(),t=a.db_names.filter(e=>e),r={};for(let e of t){let a=await b(i.current,e);r[e]=a}d(a.db_names.length?a.db_names[0]:null),u(!1),l(r)}catch(e){y.error(e.message),console.error(e)}})()},[]);let v=a[o]&&a[o].tables&&a[o].tables.length>0,j=a[o]&&a[o].metadata&&a[o].metadata.some(e=>e.column_description&&""!==e.column_description.trim()),N=null===(e=a[o])||void 0===e?void 0:e.can_connect,_=(0,s.useId)(),C=(0,s.useMemo)(()=>{if(!Object.keys(a).length)return null;let e=Object.keys(a).map(e=>({value:e,label:e}));return e=[{value:_,label:"Add new database"},...e],(0,r.jsx)("div",{className:"flex flex-row my-6 w-full gap-2 items-center",children:Object.keys(a).length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{disabled:p,label:"Select database",labelClassNames:"font-bold text-sm",allowClear:!1,allowCreateNewOption:!1,options:e,value:o||void 0,onChange:e=>d(e),placeholder:"Select your DB name",optionRenderer:e=>e.value===_?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(I.A,{className:"w-4"}),"Add new database"]}):(0,r.jsxs)("div",{className:"whitespace-pre flex items-center gap-2",children:[(0,r.jsx)(U.A,{className:"w-4"}),e.label]})}),o!==_&&(0,r.jsx)(L.A,{className:"w-5 h-5 relative top-3 cursor-pointer hover:text-rose-500",onClick:()=>{try{f(i.current,o),y.success("Database deleted"),l(e=>{let a={...e};return delete a[o],a}),d(_)}catch(e){console.error(e),y.error("Failed to delete database")}}})]})})},[y,o,p]),S=(0,s.useMemo)(()=>!o||o===_||c?null:[{name:"Database Connection",content:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(w,{token:i.current,existingDbInfo:a[o],onDbUpdatedOrCreated:(e,a)=>{d(e),l(t=>({...t,[e]:a}))}})})},{name:"AI Metadata Management",content:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(h,{token:i.current,dbInfo:a[o],onUpdate:(e,a)=>{l(t=>({...t,[e]:a}))}})})}],[c,o,a]);return c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{}),(0,r.jsx)(x.A,{id:"manage-database",userType:"admin",children:(0,r.jsxs)("div",{className:"w-full h-96 text-gray-500 dark:bg-dark-bg-primary flex items-center justify-center",children:[(0,r.jsx)(m.c5,{}),"Loading"]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.A,{}),(0,r.jsx)(x.A,{id:"manage-database",userType:"admin",children:(0,r.jsxs)("div",{className:"w-full dark:bg-dark-bg-primary px-2 md:px-0 mb-4",children:[C,Object.keys(a).length&&S?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A,{loading:c,canConnect:N,areTablesIndexed:v,hasNonEmptyDescription:j}),(0,r.jsx)("div",{className:"dark:bg-dark-bg-primary mt-4",children:(0,r.jsx)(m.tU,{rootClassNames:"w-full dark:bg-dark-bg-primary min-h-[500px]",tabs:S.map(e=>({...e,className:"!overflow-y-visible dark:bg-dark-bg-primary dark:text-dark-text-primary dark:hover:bg-dark-hover dark:border-dark-border",selectedClassName:"dark:bg-dark-hover dark:text-dark-text-primary dark:border-b-2 dark:border-blue-500"})),disableSingleSelect:!0,contentClassNames:"border dark:border-gray-700 border-t-none"})})]}):(0,r.jsxs)("div",{className:"prose dark:prose-invert max-w-none",children:[0===Object.keys(a).length&&(0,r.jsxs)("div",{className:"max-w-lg mx-auto text-center my-10",children:[(0,r.jsx)("h3",{children:"Welcome to Defog!"}),(0,r.jsx)("p",{children:"Let's get you set up with your first database connection. Connect your data source to start generating AI-powered SQL queries and reports."})]}),(0,r.jsx)(P,{token:i.current,uploadFile:e=>{let{fileName:a,fileBuffer:t}=e;g(!0),k.current.postMessage({type:"UPLOAD_FILE",token:i.current,fileName:a,fileBuffer:t},[t])},onCredsSubmit:(e,a)=>{l(t=>({...t,[e]:a})),d(e),y.success("Database ".concat(e," created successfully"))}})]})]})})]})}},9157:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});var r=t(6485);let s=(e,a)=>{if("http"!==e&&"ws"!==e)throw Error("Protocol not supported");return""!==a?"ws"===e?"".concat((r.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"").replace("http","ws"),"/").concat(a):"".concat(r.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"","/").concat(a):"".concat(r.env.NEXT_PUBLIC_AGENTS_ENDPOINT||"")}}},e=>{var a=a=>e(e.s=a);e.O(0,[894,30,636,593,792],()=>a(5495)),_N_E=e.O()}]);